<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>é“è·¯å·¥ç¨‹æŠ½ç­¾ç³»ç»Ÿ | Liquid Glass Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* åŸæ¥çš„å˜é‡ä¸æ ·å¼ä¿æŒä¸å˜ */
    :root{
      --glass:rgba(17,30,54,.4);
      --glass-border:rgba(255,255,255,.1);
      --shadow:0 12px 40px rgba(0,0,0,.3);
      --accent:#165DFF;
      --accent2:#FFD700;
      --bg:linear-gradient(135deg,#0A192F,#112240,#1A2E4F);
      --font:#E6F1FF;
      --highlight:#64FFDA;
    }
    *{margin:0;padding:0;box-sizing:border-box;font-family:"Segoe UI",Helvetica,Arial,sans-serif}
    body{background:var(--bg);min-height:100vh;display:flex;justify-content:center;align-items:flex-start;padding:30px 20px;color:var(--font)}
    #groupSelect{background:var(--glass);color:var(--font);border:1px solid var(--glass-border);border-radius:50px;padding:12px 28px;font-size:1rem;appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23E6F1FF' stroke-width='2'%3e%3cpolyline points='6 9 12 15 18 9'/%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 15px center;background-size:16px}
    #groupSelect option{background:#0A192F;color:var(--font);border:none}
    .task-label{position:absolute;top:-35px;left:50%;transform:translateX(-50%);background:var(--glass);backdrop-filter:blur(8px);border:1px solid var(--glass-border);padding:4px 10px;border-radius:12px;font-size:11px;color:var(--font);white-space:nowrap;z-index:3;box-shadow:var(--shadow)}
    .container{width:100%;max-width:1440px;display:flex;flex-direction:column;gap:30px}
    .glass-card{position:relative;padding:25px;border-radius:25px;background:var(--glass);backdrop-filter:blur(18px) saturate(180%);border:1px solid var(--glass-border);box-shadow:var(--shadow);overflow:hidden;transition:transform .3s,box-shadow .3s}
    .glass-card:hover{transform:translateY(-4px);box-shadow:0 20px 60px rgba(0,0,0,.5)}
    .glass-card::before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle at var(--x,50%) var(--y,50%),rgba(22,93,255,.3),transparent 60%);opacity:var(--opacity,0);pointer-events:none;transition:opacity .25s}
    .title{text-align:center;font-size:2.4rem;letter-spacing:2px;background:linear-gradient(90deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 10px rgba(22,93,255,.3)}
    .controls{display:flex;gap:15px;flex-wrap:wrap;justify-content:center}
    .controls select,.controls button{padding:12px 28px;font-size:1rem;border:none;border-radius:50px;background:var(--glass);color:var(--font);border:1px solid var(--glass-border);box-shadow:var(--shadow);cursor:pointer;transition:transform .2s,background .3s}
    .controls button:hover{transform:scale(1.08);background:rgba(22,93,255,.15)}
    .controls button.primary{background:var(--accent);color:#fff;font-weight:500;letter-spacing:1px}
    .main{display:flex;gap:30px;flex-wrap:wrap}
    .map-container{flex:1 1 650px;min-height:620px}
    .map-canvas{position:relative;width:100%;height:100%;border-radius:20px;overflow:hidden;background:rgba(10,25,47,.5);border:1px solid rgba(255,255,255,.05)}
    .project-point,.zone,.marker{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bold;border-radius:50%}
    .project-point{width:60px;height:60px;background:linear-gradient(145deg,var(--accent),#0A192F);box-shadow:0 0 15px rgba(22,93,255,.5);z-index:2;font-size:14px;color:#fff}
    .zone{width:47px;height:47px;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);font-size:12px;border-radius:8px;color:var(--font)}
    .marker{width:35px;height:35px;font-size:11px;animation:pulse 2.5s infinite;box-shadow:0 0 10px rgba(0,0,0,.5)}
    @keyframes pulse{0%{transform:scale(1);opacity:.8}50%{transform:scale(1.15);opacity:1}100%{transform:scale(1);opacity:.8}}
    .results-panel{flex:1 1 420px;display:flex;flex-direction:column;gap:30px}
    .results-table{overflow:auto;max-height:320px;border-radius:15px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:12px 15px;background:rgba(255,255,255,.05);border-bottom:1px solid rgba(255,255,255,.08)}
    th{background:rgba(255,255,255,.1);font-weight:600;text-align:left}
    .requirement-content{line-height:1.7;white-space:pre-wrap;font-size:15px;background:rgba(255,255,255,.05);padding:20px;border-radius:15px}
    @media(max-width:900px){.main{flex-direction:column}}

    /* === iOS 26 Liquid Glass æ–°å¢ === */
    .glass-card.liquid{animation:breathe 6s ease-in-out infinite}
    @keyframes breathe{
      0%,100%{box-shadow:0 0 20px rgba(22,93,255,.25)}
      50%{box-shadow:0 0 55px rgba(22,93,255,.55)}
    }
    .glass-card.liquid::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius:inherit;
      pointer-events:none;
      -webkit-mask-image:conic-gradient(from var(--angle,0deg),transparent 0%,rgba(255,255,255,.4) 20%,transparent 40%);
      mask-image:conic-gradient(from var(--angle,0deg),transparent 0%,rgba(255,255,255,.4) 20%,transparent 40%);
      backdrop-filter:blur(36px) saturate(240%) hue-rotate(var(--hue,0deg));
      transition:--angle .2s,--hue .2s;
    }
    @property --angle{
      syntax:"<angle>";
      inherits:false;
      initial-value:0deg
    }
    @property --scale{
      syntax:"<number>";
      inherits:false;
      initial-value:1
    }
    #bubbleLayer{position:fixed;inset:0;pointer-events:none;z-index:9999}
  </style>
</head>

<body>
  <div class="container">
    <div class="glass-card title">é“è·¯å·¥ç¨‹æŠ½ç­¾ç³»ç»Ÿ</div>

    <div class="glass-card controls">
      <select id="groupSelect" class="glass-select">
        <option value="å°å­¦">å°å­¦</option>
        <option value="åˆä¸­">åˆä¸­</option>
        <option value="é«˜ä¸­" selected>é«˜ä¸­</option>
      </select>
      <button class="primary" id="drawBtn">å¼€å§‹æŠ½ç­¾</button>
      <button id="resetBtn">é‡ç½®ç³»ç»Ÿ</button>
      <button id="exportBtn">å¯¼å‡ºç»“æœ</button>
    </div>

    <div class="main">
      <div class="glass-card map-container">
        <div class="map-canvas" id="mapCanvas"></div>
      </div>

      <div class="glass-card results-panel">
        <div class="results-table">
          <table>
            <thead>
              <tr><th>ä»»åŠ¡</th><th>å·¥ç¨‹ç‚¹</th><th>åŒºåŸŸ</th></tr>
            </thead>
            <tbody id="resultsTbody"></tbody>
          </table>
        </div>
        <div class="requirement-content" id="requirementContent">
æŠ½ç­¾ç»“æœå°†åœ¨æ­¤æ˜¾ç¤º
è¯·å…ˆé€‰æ‹©ç»„åˆ«å¹¶ç‚¹å‡»â€œå¼€å§‹æŠ½ç­¾â€
        </div>
      </div>
    </div>
  </div>

  <canvas id="bubbleLayer"></canvas>

  <script>
    /* ========== åŸæŠ½ç­¾é€»è¾‘ï¼ˆæœªæ”¹åŠ¨ï¼‰ ========== */
    const groupSelect=document.getElementById('groupSelect'),drawBtn=document.getElementById('drawBtn'),resetBtn=document.getElementById('resetBtn'),exportBtn=document.getElementById('exportBtn'),mapCanvas=document.getElementById('mapCanvas'),resultsTbody=document.getElementById('resultsTbody'),requirementContent=document.getElementById('requirementContent');
    let currentGroup='é«˜ä¸­',results={},projectPos={},zonePos={},projectElements={};

    function initMap(){
      const rect=mapCanvas.getBoundingClientRect(),scaleX=rect.width/600,scaleY=rect.height/600;
      const basePos=[[120,80],[300,80],[480,80],[120,260],[300,260],[480,260],[120,440],[300,440],[480,440]];
      basePos.forEach((p,i)=>{
        const idx=i+1,x=p[0]*scaleX,y=p[1]*scaleY;
        projectPos[idx]={x,y};
        const pp=document.createElement('div');pp.className='project-point';pp.dataset.id=idx;pp.style.left=`${x-30}px`;pp.style.top=`${y-30}px`;pp.textContent=`å·¥ç¨‹${idx}`;mapCanvas.appendChild(pp);projectElements[idx]=pp;zonePos[idx]={};
        for(let z=1;z<=4;z++){
          const zx=x+((z-1)%2)*50*scaleX-25*scaleX,zy=y+Math.floor((z-1)/2)*50*scaleY-25*scaleY;
          zonePos[idx][z]={x:zx,y:zy};
          const zd=document.createElement('div');zd.className='zone';zd.style.left=`${zx-22}px`;zd.style.top=`${zy-22}px`;zd.textContent=z;mapCanvas.appendChild(zd);
        }
      });
    }
    const shuffle=a=>a.sort(()=>Math.random()-.5),rand=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;
    function generateDraw(){
      let projects=[...Array(9)].map((_,i)=>i+1);projects=shuffle(projects);results={};
      const t1p=projects.pop(),t1z=rand(1,4);
      results['ç‰©æ–™å›æ”¶']={å·¥ç¨‹ç‚¹:t1p,åŒºåŸŸ:t1z,åæ ‡:zonePos[t1p][t1z],è¦æ±‚:['ğŸ“¦ ç‰©æ–™å›æ”¶ä»»åŠ¡',`ğŸ“ å·¥ç¨‹ç‚¹ï¼š${t1p}`,`ğŸ—ºï¸ åŒºåŸŸï¼š${t1z}`,'ğŸ“ è¦æ±‚ï¼šå°†æ˜“æ‹‰ç½æ‘†æ”¾åœ¨æŒ‡å®šåŒºåŸŸçš„æœ€è¿‘äº¤å‰çº¿']};
      const t2p=projects.pop(),t2zs=shuffle([1,2,3,4]).slice(0,3);
      results['å»ºè®¾æœåŠ¡åŒº']={å·¥ç¨‹ç‚¹:t2p,åŒºåŸŸ:t2zs,åæ ‡:t2zs.map(z=>zonePos[t2p][z]),è¦æ±‚:['ğŸ—ï¸ å»ºè®¾æœåŠ¡åŒºä»»åŠ¡',`ğŸ“ å·¥ç¨‹ç‚¹ï¼š${t2p}`,`ğŸ—ºï¸ åŒºåŸŸï¼š${t2zs.join(', ')}`,'ğŸ“ è¦æ±‚ï¼šåœ¨æŒ‡å®šçš„ä¸‰ä¸ªåŒºåŸŸåˆ†åˆ«å¹³æ”¾1ä¸ªçº¸æ¯ï¼Œå½¢æˆâ€œå“â€å­—å½¢']};
      const t3p=projects.pop(),colors=['#FF0000','#87CEFA','#00FF00'];let colorOrder='';
      if(currentGroup!=='å°å­¦'){const shuffled=shuffle([...colors]),names={'#FF0000':'çº¢','#87CEFA':'è“','#00FF00':'ç»¿'};colorOrder=`ğŸ”¢ å æ”¾é¡ºåºï¼ˆä»ä¸‹åˆ°ä¸Šï¼‰ï¼š${shuffled.map(c=>names[c]).reverse().join(' â†’ ')}`;}
      results['æ­å»ºæ¡¥æ¢']={å·¥ç¨‹ç‚¹:t3p,åæ ‡:projectPos[t3p],è¦æ±‚:['ğŸŒ‰ æ­å»ºæ¡¥æ¢ä»»åŠ¡',`ğŸ“ å·¥ç¨‹ç‚¹ï¼š${t3p}`,'ğŸ“Œ å›ºå®šæ‘†æ”¾ä½ç½®ï¼š','ğŸ”µ 1å·ä½ç½® - è“è‰²','ğŸ”´ 2 - 3ä¸­é—´çº¿ - çº¢è‰²','ğŸŸ¢ 4å·ä½ç½® - ç»¿è‰²',colorOrder||'ğŸ“ å°å­¦ç»„æ— é¡ºåºè¦æ±‚'],é¢œè‰²é¡ºåº:currentGroup==='å°å­¦'?colors:shuffle([...colors])};
      const t4p=projects.pop();const [cupZone,ballZone]=shuffle([1,2,3,4]);
      results['å»ºè®¾åŠ æ²¹ç«™']={å·¥ç¨‹ç‚¹:t4p,çº¸æ¯åŒºåŸŸ:cupZone,æ³¡æ²«çƒåŒºåŸŸ:ballZone,åæ ‡:[zonePos[t4p][cupZone],zonePos[t4p][ballZone]],è¦æ±‚:['â›½ å»ºè®¾åŠ æ²¹ç«™ä»»åŠ¡',`ğŸ“ å·¥ç¨‹ç‚¹ï¼š${t4p}`,`ğŸ¥¤ çº¸æ¯åŒºåŸŸï¼š${cupZone}`,`ğŸˆ æ³¡æ²«çƒåŒºåŸŸï¼š${ballZone}`,'ğŸ“ è¦æ±‚ï¼šå°†æ³¡æ²«çƒæ”¾ç½®åœ¨å€’æ‰£çº¸æ¯ä¸Š']};
    }
    function updateDisplay(){
      document.querySelectorAll('.marker,.task-label').forEach(m=>m.remove());
      resultsTbody.innerHTML='';requirementContent.textContent='';
      const colors={'ç‰©æ–™å›æ”¶':'#165DFF','å»ºè®¾æœåŠ¡åŒº':'#64FFDA','æ­å»ºæ¡¥æ¢':'#FFD700','å»ºè®¾åŠ æ²¹ç«™':'#FF647C'};
      Object.entries(results).forEach(([task,info])=>{
        const tr=document.createElement('tr');tr.innerHTML=`<td>${task}</td><td>${info.å·¥ç¨‹ç‚¹}</td><td>${Array.isArray(info.åŒºåŸŸ)?info.åŒºåŸŸ.join(', '):info.åŒºåŸŸ||'-'}</td>`;resultsTbody.appendChild(tr);requirementContent.textContent+=info.è¦æ±‚.join('\n')+'\n\n';
        const label=document.createElement('div');label.className='task-label';label.textContent=task;projectElements[info.å·¥ç¨‹ç‚¹].appendChild(label);
        if(task==='ç‰©æ–™å›æ”¶')createMarker(info.åæ ‡,'å›æ”¶',colors[task],35);
        else if(task==='å»ºè®¾æœåŠ¡åŒº'){createMarker(projectPos[info.å·¥ç¨‹ç‚¹],'æœåŠ¡åŒº',colors[task],50);info.åæ ‡.forEach((c,i)=>createMarker(c,`çº¸æ¯${i+1}`,colors[task],35));}
        else if(task==='æ­å»ºæ¡¥æ¢'){createMarker(projectPos[info.å·¥ç¨‹ç‚¹],'æ¡¥æ¢',colors[task],50);const base=projectPos[info.å·¥ç¨‹ç‚¹];info.é¢œè‰²é¡ºåº.forEach((color,i)=>{const m=document.createElement('div');m.className='marker';m.style.backgroundColor=color;m.style.left=`${base.x+60}px`;m.style.top=`${base.y-35+i*25}px`;m.style.width=m.style.height='20px';m.style.borderRadius='3px';m.textContent=['çº¢','è“','ç»¿'][['#FF0000','#87CEFA','#00FF00'].indexOf(color)];m.style.fontSize='9px';mapCanvas.appendChild(m)})}
        else if(task==='å»ºè®¾åŠ æ²¹ç«™'){createMarker(info.åæ ‡[0],'çº¸æ¯',colors[task],30);createMarker(info.åæ ‡[1],'æ³¡æ²«çƒ','#FFD54F',40);}
      });
    }
    function createMarker(pos,text,color,size=30){
      const m=document.createElement('div');m.className='marker';m.style.backgroundColor=color;m.style.left=`${pos.x-size/2}px`;m.style.top=`${pos.y-size/2}px`;m.style.width=m.style.height=`${size}px`;m.textContent=text;mapCanvas.appendChild(m);
    }
    function resetSystem(){
      results={};resultsTbody.innerHTML='';requirementContent.textContent='æŠ½ç­¾ç»“æœå°†åœ¨æ­¤æ˜¾ç¤º\nè¯·å…ˆé€‰æ‹©ç»„åˆ«å¹¶ç‚¹å‡»â€œå¼€å§‹æŠ½ç­¾â€';document.querySelectorAll('.marker,.task-label').forEach(m=>m.remove());
    }
    function exportResults(){
      if(Object.keys(results).length===0){alert('è¯·å…ˆæŠ½ç­¾');return;}
      let txt='é“è·¯å·¥ç¨‹æŠ½ç­¾ç»“æœ\n\n';
      Object.entries(results).forEach(([task,info])=>{
        txt+=`ä»»åŠ¡åç§°ï¼š${task}\nå·¥ç¨‹ç‚¹ï¼š${info.å·¥ç¨‹ç‚¹}\n`;
        if(Array.isArray(info.åŒºåŸŸ))txt+=`åŒºåŸŸï¼š${info.åŒºåŸŸ.join(', ')}\n`;
        else if(info.çº¸æ¯åŒºåŸŸ&&info.æ³¡æ²«çƒåŒºåŸŸ){txt+=`çº¸æ¯åŒºåŸŸï¼š${info.çº¸æ¯åŒºåŸŸ}\næ³¡æ²«çƒåŒºåŸŸï¼š${info.æ³¡æ²«çƒåŒºåŸŸ}\n`;}
        else txt+=`åŒºåŸŸï¼š${info.åŒºåŸŸ}\n`;
        txt+=`è¦æ±‚ï¼š\n${info.è¦æ±‚.map(r=>'    '+r).join('\n')}\n\n`;
      });
      const blob=new Blob([txt],{type:'text/plain'}),url=URL.createObjectURL(blob),a=document.createElement('a');
      a.href=url;a.download='é“è·¯å·¥ç¨‹æŠ½ç­¾ç»“æœ.txt';a.click();URL.revokeObjectURL(url);
    }
    /* äº‹ä»¶ç»‘å®š */
    groupSelect.addEventListener('change',e=>currentGroup=e.target.value);
    drawBtn.addEventListener('click',()=>{generateDraw();updateDisplay()});
    resetBtn.addEventListener('click',resetSystem);
    exportBtn.addEventListener('click',exportResults);

    /* === Liquid Glass åŠ¨æ€äº¤äº’ === */
    document.querySelectorAll('.glass-card').forEach(card=>{
      card.classList.add('liquid');
      card.addEventListener('mousemove',e=>{
        const r=card.getBoundingClientRect();
        const x=((e.clientX-r.left)/r.width)*100;
        const y=((e.clientY-r.top)/r.height)*100;
        card.style.setProperty('--x',`${x}%`);
        card.style.setProperty('--y',`${y}%`);
        card.style.setProperty('--opacity','1');
        /* æŠ˜å°„è§’åº¦ */
        const dx=e.clientX-r.left-r.width/2;
        const dy=e.clientY-r.top-r.height/2;
        const angle=Math.atan2(dy,dx)*180/Math.PI;
        card.style.setProperty('--angle',`${angle}deg`);
        card.style.setProperty('--hue',`${angle/6}deg`);
      });
      card.addEventListener('mouseleave',()=>card.style.setProperty('--opacity','0'));

      /* å¼¹æ€§æ‹–æ‹½ */
      let ox=0,oy=0,dx=0,dy=0;
      card.addEventListener('pointerdown',e=>{
        const r=card.getBoundingClientRect();
        ox=e.clientX-r.left-r.width/2;
        oy=e.clientY-r.top-r.height/2;
      });
      card.addEventListener('pointermove',e=>{
        if(!e.buttons)return;
        const r=card.getBoundingClientRect();
        dx=e.clientX-r.left-r.width/2-ox;
        dy=e.clientY-r.top-r.height/2-oy;
        const d=Math.hypot(dx,dy);
        if(d<1){card.style.clipPath='';return}
        const p=`polygon(
          ${-dx*0.3}px ${-dy*0.3}px,
          calc(100% - ${dx*0.3}px) calc(0% - ${dy*0.3}px),
          calc(100% + ${dx*0.3}px) calc(100% + ${dy*0.3}px),
          calc(0% + ${dx*0.3}px) calc(100% + ${dy*0.3}px))`;
        card.style.clipPath=p;
      });
      card.addEventListener('pointerup',()=>{
        card.style.transition='clip-path .35s cubic-bezier(.25,1.3,.5,1)';
        card.style.clipPath='';
        setTimeout(()=>card.style.transition='',350);
      });
    });

    /* å¾®ç²’å­æ¼‚æµ® */
    const canvas=document.getElementById('bubbleLayer');
    const ctx=canvas.getContext('2d');
    let W,H,bubbles=[];
    function resize(){W=canvas.width=innerWidth;H=canvas.height=innerHeight;}
    window.addEventListener('resize',resize);resize();
    class Bubble{
      constructor(x,y){this.x=x;this.y=y;this.r=Math.random()*2+1.4;this.vx=(Math.random()-0.5)*.3;this.vy=-Math.random()*.5-.3;this.alpha=Math.random()*.4+.2;}
      update(){this.x+=this.vx+Math.sin(Date.now()/3000+this.x)*.2;this.y+=this.vy;if(this.y<-20){this.y=H+20;this.x=Math.random()*W}}
      draw(){ctx.save();ctx.globalAlpha=this.alpha;ctx.beginPath();ctx.arc(this.x,this.y,this.r,0,Math.PI*2);ctx.fillStyle='rgba(255,255,255,.7)';ctx.fill();ctx.restore();}
    }
    for(let i=0;i<60;i++)bubbles.push(new Bubble(Math.random()*W,Math.random()*H));
    function animate(){ctx.clearRect(0,0,W,H);bubbles.forEach(b=>{b.update();b.draw()});requestAnimationFrame(animate);}
    animate();

    /* å¯åŠ¨ */
    initMap();
  </script>
</body>
</html>